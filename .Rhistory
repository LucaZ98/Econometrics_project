reg = lm(dEURUSD ~ tail(dM3,-1) + tail(dHICP,-1) + tail(dMRO,-1) + tail(dinf_USA,-1)
+ tail(dyield_diff,-1) + tail(dPetrol_USA,-1) + tail(dExtRes,-1), data=df)
reg = lm(dEURUSD[2:210] ~ tail(dM3,-1) + tail(dHICP,-1) + tail(dMRO,-1) + tail(dinf_USA,-1)
+ tail(dyield_diff,-1) + tail(dPetrol_USA,-1) + tail(dExtRes,-1), data=df)
summary(reg)
reg = lm(dEURUSD[3:210] ~ tail(dM3,-1) + tail(dHICP,-1) + tail(dMRO,-1) + tail(dinf_USA,-1)
+ tail(dyield_diff,-1) + tail(dPetrol_USA,-1) + tail(dExtRes,-1), data=df)
reg = lm(dEURUSD[2:210] ~ tail(dM3,-1) + tail(dHICP,-1) + tail(dMRO,-1) + tail(dinf_USA,-1)
+ tail(dyield_diff,-1) + tail(dPetrol_USA,-1) + tail(dExtRes,-1), data=df)
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3,0:1) + L(dHICP,0:1) + L(dMRO,0:1) + L(dinf_USA,0:1)
+ L(dyield_diff,0:1) + L(dPetrol_USA,0:1) + L(dExtRes, 0:1), data=df)
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3, 1) + L(dHICP, 1) + L(dMRO, 1) + L(dinf_USA, 1)
+ L(dyield_diff, 1) + L(dPetrol_USA, 1) + L(dExtRes, 1), data=df)
summary(reg)
reg = lm(dEURUSD[2:210] ~ tail(dM3,-1) + tail(dHICP,-1) + tail(dMRO,-1) + tail(dinf_USA,-1)
+ tail(dyield_diff,-1) + tail(dPetrol_USA,-1) + tail(dExtRes,-1), data=df)
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3, 2) + L(dHICP, 2) + L(dMRO, 2) + L(dinf_USA, 2)
+ L(dyield_diff, 2) + L(dPetrol_USA, 2) + L(dExtRes, 2), data=df)
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3, 1) + L(dHICP, 1) + L(dMRO, 1) + L(dinf_USA, 1)
+ L(dyield_diff, 1) + L(dPetrol_USA, 1) + L(dExtRes, 1), data=df)
reg = dynlm(dEURUSD ~ L(dHICP,1) + L(dinf_USA,1) + L(dyield_diff,1)
+ L(dPetrol_USA,1) + L(dExtRes), data=df)
y.VAR.IC <- VARselect(df[c("EURUSD", "M3", "yieldEU_1y", "HICP", "ExtRes",
"yieldUSA_1y", "Petrol_USA", "inf_USA")], type="const")
nlags <- y.VAR.IC$selection
nlags
y.CA <- ca.jo(df[c("EURUSD", "M3", "yieldEU_1y", "HICP", "ExtRes",
"yieldUSA_1y", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 2)
vecm
summary(vecm$rlm)
y.VAR.IC <- VARselect(df[c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")], type="const")
nlags <- y.VAR.IC$selection
nlags
y.CA <- ca.jo(df[c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 1)
# Let's see the cointegration relationship
vecm
summary(vecm$rlm)
reg = dynlm(dEURUSD ~ L(dM3, 3) + L(dHICP, 3) + L(dMRO, 3) + L(dinf_USA, 3)
+ L(dyield_diff, 3) + L(dPetrol_USA, 3) + L(dExtRes, 3), data=df)
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3, 1) + L(dHICP, 1) + L(dMRO, 1) + L(dinf_USA, 1)
+ L(dyield_diff, 1) + L(dPetrol_USA, 1) + L(dExtRes, 1), data=df)
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3, 5) + L(dHICP, 5) + L(dMRO, 5) + L(dinf_USA, 5)
+ L(dyield_diff, 5) + L(dPetrol_USA, 5) + L(dExtRes, 5), data=df)
summary(reg)
reg = lm(df$dEURUSD[2:210] ~ tail(df$dM3,-1) + tail(df$dHICP,-1) + tail(df$dMRO,-1) + tail(df$dinf_USA,-1)
+ tail(df$dyield_diff,-1) + tail(df$dPetrol_USA,-1) + tail(df$dExtRes,-1))
summary(reg)
k=5
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
k=6
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3, k) + L(dHICP, k) + L(dMRO, k) + L(dinf_USA, k)
+ L(dyield_diff, k) + L(dPetrol_USA, k) + L(dExtRes, k), data=df)
summary(reg)
k=10
reg = dynlm(dEURUSD ~ L(dM3, k) + L(dHICP, k) + L(dMRO, k) + L(dinf_USA, k)
+ L(dyield_diff, k) + L(dPetrol_USA, k) + L(dExtRes, k), data=df)
summary(reg)
k=10
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
k=12
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
k=24
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
k=56
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
reg = dynlm(dEURUSD ~ L(dM3, k) + L(dHICP, k) + L(dMRO, k) + L(dinf_USA, k)
+ L(dyield_diff, k) + L(dPetrol_USA, k) + L(dExtRes, k), data=df)
summary(reg)
k=0
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
k=1
reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
+ tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
setwd("~/GitHub/Econometrics_project")
rm(list = ls())
library("readxl")
library("lubridate")
library("ggplot2")
library("patchwork")
library("olsrr")
library("dynlm")
library("car")
library(forecast)
library(urca)
library(aTSA)
library(vars)
library(dynlm)
library(rugarch)
# Import pf the dataset
df = read_excel("dataset.xlsx")
df_1 = read.csv("MABMM301USM189S.csv")
df$M3_USA = df_1$MABMM301USM189S
df_1 = read.csv("DGS1.csv")
df$yieldUSA_1y = df_1$DGS1
df_1 = read.csv("DCOILWTICO.csv")
df_1 <- head(df_1, -1)
df$Petrol_USA = df_1$DCOILWTICO
inf_df = read.table("inf_rate.txt", sep = "")
inf_rate = inf_df[2:(length(inf_df)-1)]
d = c()
for (i in 1: 19)
{
d = c(d, inf_rate[20-i,])
}
d = d[10:(length(d)-9)]
d
d = as.numeric(d)
df$inf_USA = d
# Plot of all our time series
p1 <- ggplot(df, aes(x=Data, y=EURUSD)) +
geom_line() +
xlab("")
p2 <- ggplot(df, aes(x=Data, y=M3)) +
geom_line() +
xlab("")
p3 <- ggplot(df, aes(x=Data, y=HICP)) +
geom_line() +
xlab("")
p4 <- ggplot(df, aes(x=Data, y=MRO)) +
geom_line() +
xlab("")
p5 <- ggplot(df, aes(x=Data, y=yieldEU_1y)) +
geom_line() +
xlab("")
p6 <- ggplot(df, aes(x=Data, y=ExtRes)) +
geom_line() +
xlab("")
p7 <- ggplot(df, aes(x=Data, y=yieldUSA_1y)) +
geom_line() +
xlab("")
p8 <- ggplot(df, aes(x=Data, y=M3_USA)) +
geom_line() +
xlab("")
p9 <- ggplot(df, aes(x=Data, y=Petrol_USA)) +
geom_line() +
xlab("")
p10 <- ggplot(df, aes(x=Data, y=inf_USA)) +
geom_line() +
xlab("")
p1+p2+p3+p4+p5+p6+p7+p8+p9+p10
################################################################################
################################################################################
#
# FIRST MODEL: Regression on I(0) variables
#
################################################################################
################################################################################
# We want to see if we can find a relationship between our I(0) variables and
# the differences in exchange rate EUR/USD
################################################################################
# UNIT ROOT TEST
################################################################################
# First, we test whether our time series are I(1)
# Before doing so, we introduce another time series:
# Difference between interest rates in USA w.r.t. the
# ones in EU
df$yield_diff = df$yieldUSA_1y - df$yieldEU_1y
p11 <- ggplot(df, aes(x=Data, y=yield_diff)) +
geom_line() +
xlab("")
p1+p2+p3+p4+p5+p6+p7+p8+p9+p10+p11
############### ERS TEST
# H0: Non-stationary
# H1: stationary
# Se la statistica è maggiore di un certo valore critico => non posso rifiutare H0, quindi
# non posso rifiutare la non stazionarità
summary(ur.ers(df$EURUSD, type="P-test", model="trend"))
summary(ur.ers(df$M3, type="P-test", model="trend"))
summary(ur.ers(df$HICP, type="P-test", model="trend"))
summary(ur.ers(df$MRO, type="P-test", model="trend"))
summary(ur.ers(df$yieldEU_1y, type="P-test", model="trend"))
summary(ur.ers(df$ExtRes, type="P-test", model="trend")) #al 5% è stat
summary(ur.ers(df$M3_USA, type="P-test", model="trend"))
summary(ur.ers(df$inf_USA, type="P-test", model="trend"))
summary(ur.ers(df$Petrol_USA, type="P-test", model="trend")) #al 5% è stat
summary(ur.ers(df$yieldUSA_1y, type="P-test", model="trend"))
summary(ur.ers(df$yield_diff, type="P-test", model="trend"))
# We now create the first differences of our time series
dEURUSD = diff(df$EURUSD)
dM3 = diff(df$M3)
dHICP = diff(df$HICP)
dMRO = diff(df$MRO)
dyieldEU = diff(df$yieldEU_1y)
dExtRes = diff(df$ExtRes)
dM3_USA = diff(df$M3_USA)
dyieldUSA = diff(df$yieldUSA_1y)
dinf_USA = diff(df$inf_USA)
dPetrol_USA = diff(df$Petrol_USA)
dyield_diff = diff(df$yield_diff)
# We insert these new time series in the dataset
df$dEURUSD = c(NA, dEURUSD)
df$dM3 = c(NA, dM3)
df$dHICP = c(NA, dHICP)
df$dMRO = c(NA, dMRO)
df$dyieldEU = c(NA, dyieldEU)
df$dExtRes = c(NA, dExtRes)
df$dM3_USA = c(NA, dM3_USA)
df$dyieldUSA = c(NA, dyieldUSA)
df$dinf_USA = c(NA, dinf_USA)
df$dPetrol_USA = c(NA, dPetrol_USA)
df$dyield_diff = c(NA, dyield_diff)
# Plot of the differences
p1 <- ggplot(df, aes(x=Data, y=dEURUSD)) +
geom_line() +
xlab("")
p2 <- ggplot(df, aes(x=Data, y=dM3)) +
geom_line() +
xlab("")
p3 <- ggplot(df, aes(x=Data, y=dHICP)) +
geom_line() +
xlab("")
p4 <- ggplot(df, aes(x=Data, y=dMRO)) +
geom_line() +
xlab("")
p5 <- ggplot(df, aes(x=Data, y=dyieldEU)) +
geom_line() +
xlab("")
p6 <- ggplot(df, aes(x=Data, y=dExtRes)) +
geom_line() +
xlab("")
p7 <- ggplot(df, aes(x=Data, y=dyieldUSA)) +
geom_line() +
xlab("")
p8 <- ggplot(df, aes(x=Data, y=dM3_USA)) +
geom_line() +
xlab("")
p9 <- ggplot(df, aes(x=Data, y=dPetrol_USA)) +
geom_line() +
xlab("")
p10 <- ggplot(df, aes(x=Data, y=dinf_USA)) +
geom_line() +
xlab("")
p11 <- ggplot(df, aes(x=Data, y=dyield_diff)) +
geom_line() +
xlab("")
p1+p2+p3+p4+p5+p6+p8+p9+p10+p11
# We calculate the ERS test on the differences
summary(ur.ers(df$dEURUSD, type="P-test", model="trend"))
summary(ur.ers(df$dM3, type="P-test", model="trend"))
summary(ur.ers(df$dHICP, type="P-test", model="trend"))
summary(ur.ers(df$dMRO, type="P-test", model="trend"))
summary(ur.ers(df$dyieldEU, type="P-test", model="trend"))
summary(ur.ers(df$dExtRes, type="P-test", model="trend"))
summary(ur.ers(df$dM3_USA, type="P-test", model="trend"))
summary(ur.ers(df$dinf_USA, type="P-test", model="trend"))
summary(ur.ers(df$dPetrol_USA, type="P-test", model="trend"))
summary(ur.ers(df$dyieldUSA, type="P-test", model="trend"))
summary(ur.ers(df$dyield_diff, type="P-test", model="trend"))
# They are all stationary at 5% (and also at 1%)
############### ADF TEST
# H0: non stationary
# H1: stationary
# pvalue alto => non possiamo rifiutare H0
# Prima bisogna scegliere che tipo di test effettuare in base a come sono strutturati i dati
# Se no intercept e no trend, intercept e no trend o intercept e trend
adf.test(as.matrix(df$EURUSD))
adf.test(as.matrix(df$M3))
adf.test(as.matrix(df$HICP))
adf.test(as.matrix(df$MRO))
adf.test(as.matrix(df$yieldEU_1y))
adf.test(as.matrix(df$ExtRes)) # Borderline: with drift and trend for 5% it depends
# on the lags I consider (at 5%)
adf.test(as.matrix(df$yieldUSA_1y))
adf.test(as.matrix(df$M3_USA))
adf.test(as.matrix(df$Petrol_USA)) # with 0, 4 and 5 lags it is stationary, with 1, 2, 3
# instead it is stationary (at 5%)
adf.test(as.matrix(df$inf_USA))
adf.test(as.matrix(df$yield_diff))
# We apply the test to the first differences
adf.test(as.matrix(df$dEURUSD))
adf.test(as.matrix(df$dM3))
adf.test(as.matrix(df$dHICP))
adf.test(as.matrix(df$dMRO))
adf.test(as.matrix(df$dyieldEU))
adf.test(as.matrix(df$dExtRes))
adf.test(as.matrix(df$dyieldUSA))
adf.test(as.matrix(df$dM3_USA))
adf.test(as.matrix(df$dPetrol_USA))
adf.test(as.matrix(df$dinf_USA))
adf.test(as.matrix(df$dyield_diff))
# They are all stationary => All the time series are I(1)
# (except, maybe, for ExtRes and Petrol)
###############################################################################
#Siccome tutte le variabili sono I(1) la regressione sulle variabili originarie
#non ha senso a meno che non siano cointegrate (relazioni spurie) -> regressione
#serie differenziate
reg = dynlm(dEURUSD ~ L(dExtRes, 1) + L(dM3,1) + L(dMRO,1), data=df)
summary(reg)
# Test on dM3 and dMRO
linearHypothesis(reg, rbind(c(0,0,1,0), c(0,0,0,1)), c(0,0))
#p-value 0.8739: reject H0
reg = dynlm(dEURUSD ~ L(dExtRes, 1), data=df)
#reg = dynlm(dEURUSD ~ L(dM3,1) + L(dHICP,1) + L(dMRO,1) + L(dinf_USA,1) + L(dyield_diff,1) + L(dPetrol_USA,1), data=df)
reg = dynlm(dEURUSD ~ dM3 + dHICP + dMRO + dinf_USA + dyield_diff + dPetrol_USA, data=df)
summary(reg)
plot(reg)
# Try regression with all our I(0) time series
k=1
reg = dynlm(dEURUSD ~ L(dM3, k) + L(dHICP, k) + L(dMRO, k) + L(dinf_USA, k)
+ L(dyield_diff, k) + L(dPetrol_USA, k) + L(dExtRes, k), data=df)
#reg = lm(df$dEURUSD[(1+k):210] ~ tail(df$dM3,-k) + tail(df$dHICP,-k) + tail(df$dMRO,-k) + tail(df$dinf_USA,-k)
#        + tail(df$dyield_diff,-k) + tail(df$dPetrol_USA,-k) + tail(df$dExtRes,-k))
summary(reg)
plot(reg)
y.VAR.IC <- VARselect(df[c("EURUSD", "M3", "yieldEU_1y", "HICP", "ExtRes",
"yieldUSA_1y", "Petrol_USA", "inf_USA")], type="const")
nlags <- y.VAR.IC$selection
nlags
y.CA <- ca.jo(df[c("EURUSD", "M3", "yieldEU_1y", "HICP", "ExtRes",
"yieldUSA_1y", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 2)
vecm
summary(vecm$rlm)
predict(vecm, n.ahead=5)
help(predict)
help(cajorls)
predict(vecm$rlm[,1])
plot(df$EURUSD, type='l')
lines(vecm$rlm$fitted.values[,1], col='red')
vecm$rlm$fitted.values[,1]
plot(df$EURUSD[3:210], type='l')
lines(vecm$rlm$fitted.values[,1], col='red')
plot(vecm$rlm$fitted.values[,1])
plot(vecm$rlm$fitted.values[,1], type='l')
mean(vecm$rlm$fitted.values[,1])
cumsum(vecm$rlm$fitted.values[,1])
cumsum(1:5)
plot(df$EURUSD[3:210], type='l')
res = vecm$rlm$residuals[,1]
plot(res^2, type = "l")
plot(res, type = "l")
y.VAR.IC <- VARselect(df[c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")], type="const")
nlags <- y.VAR.IC$selection
nlags
y.CA <- ca.jo(df[c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 1)
# Let's see the cointegration relationship
vecm
summary(vecm$rlm)
plot(df$EURUSD[3:210], type='l')
lines(c(0)*280, col = 'red')
c(0)*3
lines(c(3:210)*0, col = 'red')
c(3:210)*0
lines(c(3:210)*0+1, col = 'red')
lines(c(3:210)*0+1.2, col = 'red')
plot(df$EURUSD[3:210], type='l')
lines(c(3:210)*0+ mean(df$EURUSD), col = 'red')
lines(vecm$rlm$residuals[,1])
plot(vecm$rlm$fitted.values[,1])
plot(vecm$rlm$fitted.values[,1], type="l")
plot(vecm$rlm$fitted.values[,2], type="l")
plot(vecm$rlm$fitted.values[,3], type="l")
plot(vecm$rlm$fitted.values[,4], type="l")
plot(vecm$rlm$fitted.values[,5], type="l")
plot(vecm$rlm$fitted.values[,6], type="l")
plot(vecm$rlm$fitted.values[,7], type="l")
plot(vecm$rlm$fitted.values[,8], type="l")
plot(vecm$rlm$fitted.values[,1], type="l")
lines(diff(df$EURUSD), col='red')
plot(cumsum(vecm$rlm$fitted.values[,1]), type="l")
lines(cumsum(diff(df$EURUSD)), col='red')
plot(df$EURUSD[1] + cumsum(vecm$rlm$fitted.values[,1]), type="l")
lines(df$EURUSD[1] + cumsum(diff(df$EURUSD)), col='red')
vecm$beta
beta = vecm$beta
plot(df$EURUSD)
plot(df$EURUSD, type='l')
lines(df$EURUSD[1] + cumsum(vecm$rlm$fitted.values[,1]), col='red')
beta
long_run_trend = beta[2]*df$M3 + beta[3]*df$yield_diff + beta[4]*df$dHICP + beta[5]*df$ExtRes + beta[6]*df$Petrol_USA + beta[7]*df$inf_USA + beta[8]
lines(long_run_trend, col="green")
mean(long_run_trend)
long_run_trend
plot(df$EURUSD)
plot(df$EURUSD, type='l')
lines(df$EURUSD[1] + cumsum(vecm$rlm$fitted.values[,1]), col='red')
mean(long_run_trend[2:210])
lines(-long_run_trend, col='green')
plot(df$EURUSD, type='l')
plot(-long_run_trend, type='l')
lines(df$EURUSD, col='green')
plot(df$EURUSD, type='l')
lines(df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1], col='green'))
lines(df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green'))
lines(df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
View(vecm)
plot(x=df$Data, y=df$EURUSD, type='l')
lines(df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
lines(df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
res = vecm$rlm$residuals[,1]
plot(x=df$Data, y=df$EURUSD, type='l')
lines(df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
y.CA <- ca.jo(df[c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 1)
# Let's see the cointegration relationship
vecm
summary(vecm$rlm)
plot(x=df$Data, y=df$EURUSD, type='l')
lines(df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
lines(x=df$Data[2:210], df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
lines(x=df$Data, df$EURUSD[1]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
plot( y=df$EURUSD, type='l')
plot(df$EURUSD, type='l')
x11()
plot(df$EURUSD, type='l')
lines(df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1])
plot(x=df$Data, y=df$EURUSD, type='l')
lines(df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
lines(x=df$Data[3:210], y=df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
x11()
plot(x=df$Data, y=df$EURUSD, type='l')
lines(x=df$Data[3:210], y=df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
y.CA <- ca.jo(df[1:200,c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 1)
y.CA <- ca.jo(df[1:205,c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 1)
# Let's see the cointegration relationship
vecm
summary(vecm$rlm)
x11()
plot(x=df$Data, y=df$EURUSD, type='l')
lines(x=df$Data[3:210], y=df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
lines(x=df$Data[3:205], y=df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
x11()
plot(x=df$Data, y=df$EURUSD, type='l')
lines(x=df$Data[3:205], y=df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
plot(x=df$Data[1:205], y=df$EURUSD, type='l')
plot(x=df$Data[1:205], y=df$EURUSD[1:205], type='l')
lines(x=df$Data[3:205], y=df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
pred = predict(vecm$rlm[,1], newdata=df[205:210,])
pred = predict(vecm$rlm[,1], newdata=df[205:210])
# Let's see the cointegration relationship
vecm
summary(vecm$rlm)
plot(x=df$Data[1:205], y=df$EURUSD[1:205], type='l')
lines(x=df$Data[3:205], y=df$EURUSD[2]+cumsum(vecm$rlm$fitted.values[,1]), col='green')
pred = predict(vecm$rlm[1], newdata=df[205:210])
pred = predict(vecm$rlm[1], newdata=df[205:210,])
pred = predict(vecm$rlm[1], newdata=as.matrix(df[205:210,c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")]))
pred
pred = forecast(vecm$rlm[1], newdata=as.matrix(df[205:210,c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")]))
pred = forecast(vecm$rlm[1], newdata=df[205:210,c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")])
df[205:210,c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")]
pred = forecast(vecm$rlm[1], newdata=df[205:210,c("M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")])
pred = forecast::forecast(vecm$rlm[1], newdata=df[205:210,c("M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")])
help("forecast")
pred = predict(vecm$rlm[1], newdata=df[205:210,c("M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")])
vecm$rlm[1]
pred = predict(vecm$rlm$model, newdata=df[205:210,c("M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")])
vecm$rlm$model
y.CA <- ca.jo(df[c("EURUSD", "M3", "yield_diff", "HICP",
"ExtRes", "Petrol_USA", "inf_USA")],
type="trace", ecdet = "const", spec="longrun", K=2)
summary(y.CA)
vecm<-cajorls(y.CA, r = 1)
# Let's see the cointegration relationship
vecm
